(this["webpackJsonpcable-club-client-proto"]=this["webpackJsonpcable-club-client-proto"]||[]).push([[0],{31:function(e,t,s){},42:function(e,t,s){"use strict";s.r(t);s(31);var n=s(18),c=s(12),i="session_reset_session",o="session_set_code",r="session_set_session_state",a="active",l="inactive",d="seeking",u=s(0),j=s.n(u),b={session:{code:null,state:l}},x=function(e,t){switch(t.type){case i:return Object(c.a)(Object(c.a)({},e),{},{session:b.session});case o:return Object(c.a)(Object(c.a)({},e),{},{session:{code:t.code,state:d}});case r:return Object(c.a)(Object(c.a)({},e),{},{session:Object(c.a)(Object(c.a)({},e.session),{},{state:t.state})});default:return e}},f=j.a.createContext(),h=s(10),g=s(2),p=s(1);var m=function(){var e=Object(g.f)(),t=Object(u.useContext)(f),s=t.store,n=t.dispatch,c=s.session;return Object(u.useEffect)((function(){if(c.state===a&&c.code){return function(){!function(){console.log("cleaning up session",c);var e=window.setTimeout((function(){console.log("done cleaning up")}),1e3)}()}}}),[c]),c.state===a&&c.code||e.replace("/"),Object(p.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-6",children:[Object(p.jsx)("h1",{children:"You are in session:"}),Object(p.jsx)("span",{className:"text-7xl font-display bg-gameboy-green-lightest text-gameboy-green-darkest p-4 rounded-md",children:c.code}),Object(p.jsx)("span",{className:"text-sm underline cursor-pointer",onClick:function(){n({type:i}),e.replace("/")},role:"button",children:"Leave session"})]})},O=s(24),y=s.p+"static/media/load.ba664b10.gif";function v(){var e=Object(u.useContext)(f).dispatch;return Object(p.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-6",children:[Object(p.jsx)("h1",{children:"Searching for your session..."}),Object(p.jsx)("img",{alt:"",src:y,width:"20"}),Object(p.jsx)("span",{className:"text-sm underline cursor-pointer",onClick:function(){e({type:i})},role:"button",children:"Cancel"})]})}function w(){var e=Object(u.useContext)(f),t=e.store,s=e.dispatch,n=t.session;return Object(p.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-6",children:[Object(p.jsx)("label",{htmlFor:"code",children:Object(p.jsx)("h1",{children:"Enter your code"})}),Object(p.jsx)(O.b,{initialValues:{code:""},onSubmit:function(e,t){var n=t.setSubmitting;s({type:o,code:e.code}),n(!1)},children:function(e){var t=e.isSubmitting,s=e.values,c=e.handleChange;return Object(p.jsxs)(O.a,{className:"flex items-center justify-center space-x-3",children:[Object(p.jsx)("input",{autoComplete:"off",className:"focus:border-gameboy-green-lightest focus:ring-1 focus:ring-gameboy-green-lightest focus:outline-none w-4/12 text-center font-display uppercase text-4xl text-gray-900 placeholder-gray-500 border border-gameboy-green-lightest rounded-md py-3",id:"code",name:"code",onChange:function(e){if(e.target.value.length>6)return!1;if(!e.target.value.match(/^[a-zA-Z0-9]*$/))return!1;c(e)},placeholder:"------",required:!0,type:"text",value:s.code}),Object(p.jsx)("button",{className:"font-display text-4xl rounded-md py-3 px-5 bg-gameboy-green-lightest text-gameboy-green-darkest disabled:bg-gameboy-green",disabled:s.code.length<6||t||n.state!==l,type:"submit",children:"Go"})]})}}),Object(p.jsx)(h.b,{className:"text-sm underline",to:"/",children:"Go back"})]})}var N=function(){var e,t=Object(g.f)(),s=Object(u.useContext)(f),n=s.store,c=s.dispatch,i=n.session;switch(Object(u.useEffect)((function(){if(i.state===d){var e=window.setTimeout((function(){console.log("joining session"),c({type:r,state:a}),t.replace("/session")}),2500);return function(){window.clearTimeout(e)}}}),[c,t,i.state]),i.state){case a:return null;case d:e=Object(p.jsx)(v,{});break;case l:e=Object(p.jsx)(w,{});break;default:throw new Error("Invalid session state")}return e},C=s(23),k=s.n(C),S=s(29);function E(){return Object(p.jsx)("div",{className:"flex flex-col items-center justify-center py-12",children:Object(p.jsx)("img",{alt:"",src:y,width:"20"})})}var T=function(){var e=Object(u.useState)(null),t=Object(n.a)(e,2),s=t[0],c=t[1],l=Object(g.f)(),d=Object(u.useContext)(f).dispatch;return Object(u.useEffect)((function(){if(!s){function e(){return(e=Object(S.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("fetching session code"),e.next=3,new Promise((function(e){window.setTimeout((function(){e({code:Math.random().toString().slice(2,8)})}),800)}));case 3:t=e.sent,console.log("got code response",t),c(t.code);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}}),[s,c]),Object(u.useEffect)((function(){if(s){var e=window.setTimeout((function(){console.log("joining session "+s),d({type:o,code:s}),d({type:r,state:a}),l.replace("/session")}),8e3);return function(){window.clearTimeout(e)}}}),[s,d,l]),s?Object(p.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-10",children:[Object(p.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-3",children:[Object(p.jsx)("h1",{children:"Your Cable Club code is:"}),Object(p.jsx)("span",{className:"text-7xl font-display bg-gameboy-green-lightest text-gameboy-green-darkest p-4 rounded-md",children:s}),Object(p.jsx)("span",{children:'Have your Player 2 click "Join Session" and enter this code.'})]}),Object(p.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-2",children:[Object(p.jsx)("h2",{children:"Searching for a partner..."}),Object(p.jsx)("img",{alt:"",src:y,width:"20"})]}),Object(p.jsx)("span",{className:"text-sm underline cursor-pointer",onClick:function(){console.log("ending session"),d({type:i}),console.log("ended session"),l.replace("/")},role:"button",children:"End Session"})]}):Object(p.jsx)(E,{})};function _(){return Object(p.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[Object(p.jsx)("h1",{children:"Welcome to the Cable Club!"}),Object(p.jsxs)("div",{className:"flex items-center justify-center space-x-20 mt-20 w-10/12",children:[Object(p.jsx)(h.b,{className:"bg-gameboy-green-lightest px-4 py-2 text-xl font-display text-gameboy-green-darkest rounded hover:bg-gameboy-green-light",to:"/host",children:"Start session"}),Object(p.jsx)(h.b,{className:"bg-gameboy-green-lightest px-4 py-2 text-xl font-display text-gameboy-green-darkest rounded hover:bg-gameboy-green-light",to:"/join",children:"Join session"})]})]})}var F=function(){return Object(p.jsx)("div",{className:"bg-purple-900 rounded-xl p-16 w-1/2",children:Object(p.jsx)(h.a,{basename:"/cable-club-client-proto",children:Object(p.jsxs)(g.c,{children:[Object(p.jsx)(g.a,{path:"/session",children:Object(p.jsx)(m,{})}),Object(p.jsx)(g.a,{path:"/host",children:Object(p.jsx)(T,{})}),Object(p.jsx)(g.a,{path:"/join",children:Object(p.jsx)(N,{})}),Object(p.jsx)(g.a,{exact:!0,path:"/",children:Object(p.jsx)(_,{})})]})})})};var P=function(){var e=Object(u.useReducer)(x,b),t=Object(n.a)(e,2),s=t[0],c=t[1];return Object(p.jsx)(f.Provider,{value:{store:s,dispatch:c},children:Object(p.jsx)("div",{className:"h-screen flex flex-col items-center justify-center bg-gray-900 text-gray-50",children:Object(p.jsx)(F,{})})})},J=s(30),I=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,43)).then((function(t){var s=t.getCLS,n=t.getFID,c=t.getFCP,i=t.getLCP,o=t.getTTFB;s(e),n(e),c(e),i(e),o(e)}))};s.n(J).a.render(Object(p.jsx)(j.a.StrictMode,{children:Object(p.jsx)(P,{})}),document.getElementById("root")),I()}},[[42,1,2]]]);
//# sourceMappingURL=main.8d4e696a.chunk.js.map